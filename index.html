<!DOCTYPE HTML>
<html>

<head>
  <title>lego-gears: helping you find gear trains the easy way</title>
  <script src="web/jquery-2.1.0.min.js"></script>
  <script src="web/fraction.min.js"></script>
  <script src="web/underscore.js"></script>
  <script src="web/raphael-min.js"></script>
  <script src="web/LegoCanvas.js"></script>


</head>

<body style="background-color:gray">
  <p>
    <input type="text" id="objectives" size="50" />
    <input type="submit" id="submit" value="find gear trains" />
    <span id="status_message">Ready.</span>
  </p>

  <p id="advanced">
    ADVANCED (takes way longer to calculate!!!)
    <br />
    <input type="checkbox" id="allow_two_gears_on_same_axle" />Allow Two Gears On Same Axle
    <br />
    <input type="checkbox" id="negative_movements_allowed" />Negative Movements Allowed
  </p>

  <!-- <hr /> -->

  <!-- <p id="filters"> -->
  <!--   FILTERS -->
  <!--   <br /> -->
  <!--   <input type="checkbox" id="allow_big_gears" />Allow 36 and 40 tooth gears -->
  <!--   <br /> -->
  <!--   <input type="checkbox" id="shortest_trains_only" />Shortest trains only -->
  <!--   <br /> -->
  <!-- </p> -->

  <hr />

  <div id="canvas_container" style="float:left"></div>

  <p id="solutions" style="float:left, padding:10px"></p>

  <script>
    var lego_canvas = LegoCanvas(document.getElementById("canvas_container"));

    var list_of_solutions;

    var worker = new Worker('web/worker.js');
    worker.onerror = function(event) {
      throw new Error(event.message + " (" + event.filename + ":" + event.lineno + ")");
    };
    worker.onmessage = function(event) {
      $("#status_message").text("Ready.");
      list_of_solutions = event.data;
      var html_solutions = "";

      _.each(list_of_solutions,
        function(solution) {
          html_solutions += "<input class=\"solution\" type=\"radio\" name=\"gear_train\" " +
            "value=\"" + JSON.stringify(solution) + "\">" +
            JSON.stringify(solution) + "</input><br />";
        });
      $("#solutions").html(html_solutions);
      $(".solution").click(function() {
        lego_canvas("create_gear_train")(JSON.parse($(".solution:checked").val()));
      });
    };
    $("#submit").click(function() {
      try {
        $("#status_message").text("computing...");
        var message = {
          objectives: JSON.parse($("#objectives").val()),
          allow_two_gears_on_same_axle: $("#allow_two_gears_on_same_axle").prop('checked'),
          negative_movements_allowed: $("#negative_movements_allowed").prop('checked')
        }
        worker.postMessage(message);
      } catch (err) {
        $("#status_message").text("Error: " + err.message);
      }
    });
  </script>

  <a href="https://github.com/2sb18/lego-gears">
    <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://github-camo.global.ssl.fastly.net/652c5b9acfaddf3a9c326fa6bde407b87f7be0f4/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6f72616e67655f6666373630302e706e67"
    alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png">
  </a>


</body>

</html>

